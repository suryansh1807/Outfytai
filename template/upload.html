{% extends "layout.html" %}
{% block title %}Upload | OutfytAI{% endblock %}

{% block content %}
<div class="space-y-6">

  <!-- Page Title -->
  <h2 class="text-xl font-semibold text-center">
    Upload Your Clothes
  </h2>

  <!-- Upload Form -->
  <form method="POST" enctype="multipart/form-data" class="space-y-4">

    <!-- Upload Box -->
    <label class="block border-2 border-dashed border-secondary
                  rounded-2xl p-6 text-center cursor-pointer bg-white">

      <p class="text-secondary text-sm mb-2">
        Tap to upload clothing images
      </p>

      <p id="file-count" class="text-xs text-primary hidden">
        0 images selected
      </p>

      <input
        type="file"
        name="images"
        multiple
        accept="image/*"
        hidden
        onchange="previewImages(event)"
      />
    </label>

    <!-- Image Preview Grid -->
    <div id="preview" class="grid grid-cols-3 gap-2"></div>

    <!-- Submit Button -->
    <button type="submit"
      class="w-full bg-primary text-light py-4 rounded-2xl font-medium">
      Get Outfit Suggestion
    </button>

  </form>

  <!-- AI RESULT SECTION -->
  {% if outfits %}
  <div class="space-y-4 mt-6">

    <h3 class="text-lg font-semibold text-center">
      Suggested Outfits
    </h3>

    {% for outfit in outfits %}
    <div class="
      bg-white/30 backdrop-blur-lg
      border border-white/40
      rounded-2xl p-4 shadow-xl
    ">

      {% if outfit.image_url %}
      <img src="{{ outfit.image_url }}"
           alt="Outfit Image"
           class="w-full rounded-xl mb-3">
      {% endif %}

      <h4 class="font-semibold text-base">
        {{ outfit.title }}
      </h4>

      <ul class="text-sm mt-2 space-y-1">
        <li>ðŸ‘• {{ outfit.top }}</li>
        <li>ðŸ‘– {{ outfit.bottom }}</li>
        <li>ðŸ‘Ÿ {{ outfit.shoes }}</li>
      </ul>

      <p class="text-secondary text-xs mt-3">
        {{ outfit.note }}
      </p>
    </div>
    {% endfor %}

  </div>
  {% endif %}

</div>

<!-- Image Preview Script -->
<script>
  function previewImages(event) {
    const files = event.target.files;
    const preview = document.getElementById("preview");
    const countText = document.getElementById("file-count");

    preview.innerHTML = "";

    if (files.length > 0) {
      countText.classList.remove("hidden");
      countText.textContent = `${files.length} image(s) selected`;
    }

    Array.from(files).forEach(file => {
      const img = document.createElement("img");
      img.src = URL.createObjectURL(file);
      img.className =
        "w-full h-24 object-cover rounded-xl border border-secondary";

      preview.appendChild(img);
    });
  }
</script>
{% endblock %}
